# Dynamic Metadata Modal - Asset-Type Specific Fields âœ¨

## Overview

The metadata modal now **dynamically adapts** to show different fields based on the asset type, reflecting the specialized metadata generated by the system.

---

## How It Works

### **1. Automatic Metadata Generation**

```
User captures item (screenshot, video, code, etc.)
  â†“
Item saved to Space
  â†“
(1 second delay)
  â†“
maybeAutoGenerateMetadata() called
  â†“
Gets Space context: {
  name: "Design Project",
  purpose: "UI/UX mockups", 
  tags: ["design", "ui", "figma"]
}
  â†“
Routes to specialized handler based on type:
  - Image â†’ generateImageMetadata()
  - Video â†’ generateVideoMetadata()
  - Code â†’ generateTextMetadata()
  - etc.
  â†“
Builds specialized prompt with Space context
  â†“
Calls Claude API
  â†“
Returns type-specific metadata:
  - Images: category, extracted_text, app_detected
  - Videos: speakers, keyPoints, targetAudience
  - Code: language, functions, dependencies
  - etc.
  â†“
Saves metadata to item
  â†“
Notification: "âœ¨ AI Analysis Complete"
```

---

### **2. Dynamic Modal Display**

```
User clicks "Edit Metadata" button
  â†“
showMetadataModal(itemId) called
  â†“
Loads item and metadata
  â†“
getMetadataSchemaForType(item) determines schema
  â†“
buildDynamicMetadataFields() generates HTML
  â†“
Modal shows type-specific fields!
```

---

## Asset-Type Schemas

### ğŸ“¸ **IMAGE** (Screenshots, Photos, Diagrams)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… Category (screenshot|photo|diagram|design|chart)
- âœ… **Extracted Text** (text visible in image)
- âœ… **Visible URLs** (URLs shown in image)
- âœ… **App Detected** (VS Code, Figma, Chrome, etc.)
- âœ… Instructions
- âœ… Tags
- âœ… Notes

**Example:**
```
Title: "VS Code - React Component"
Description: "Screenshot of VS Code showing React authentication component with useState hooks"
Category: screenshot
Extracted Text: "import React, { useState } from 'react'..."
App Detected: "VS Code"
Tags: code, react, vscode, component
```

---

### ğŸ¬ **VIDEO** (YouTube, Recordings, Tutorials)

**Fields Shown:**
- âœ… Title
- âœ… **Short Description** (one sentence)
- âœ… **Long Description** (detailed)
- âœ… **Category** (tutorial|interview|presentation|educational)
- âœ… Topics
- âœ… **Speakers** (names of people in video)
- âœ… **Key Points** (main takeaways)
- âœ… **Target Audience** (who it's for)
- âœ… Tags
- âœ… Notes

**Example:**
```
Title: "Ilya Sutskever on AI Research"
Short Description: "Discussion about AI scaling and research"
Long Description: "In-depth conversation about the shift from scaling to research-focused AI development..."
Category: interview
Speakers: Ilya Sutskever, Dwarkesh Patel
Key Points:
  - Scaling has reached limits
  - Moving to age of research
  - Value functions important
Target Audience: "AI researchers and ML engineers"
```

---

### ğŸ’» **CODE** (JavaScript, Python, etc.)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **Language** (JavaScript/React, Python, etc.)
- âœ… **Purpose** (what the code does)
- âœ… **Functions** (main functions/classes)
- âœ… **Dependencies** (libraries used)
- âœ… **Complexity** (simple|moderate|complex)
- âœ… Tags
- âœ… Notes

**Example:**
```
Title: "React useAuth Hook"
Description: "Custom React hook for managing authentication state..."
Language: "JavaScript/React"
Purpose: "Authentication state management"
Functions: useAuth, login, logout, checkAuth
Dependencies: react, axios, jwt-decode
Complexity: moderate
Tags: react, hooks, authentication, custom-hook
```

---

### ğŸ“„ **PDF** (Documents, Reports)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **Document Type** (report|manual|invoice|presentation|contract)
- âœ… **Subject** (main topic)
- âœ… **Category** (Business|Technical|Legal, etc.)
- âœ… **Purpose** (why this document exists)
- âœ… Topics
- âœ… Tags
- âœ… Notes

**Example:**
```
Title: "Q4 2025 Financial Report"
Description: "Quarterly financial analysis and projections"
Document Type: report
Subject: "Financial reporting"
Category: Business
Purpose: "Quarterly business analysis"
Topics: finance, revenue, expenses, projections
Tags: finance, report, q4, 2025, business
```

---

### ğŸ“Š **DATA FILE** (JSON, CSV, YAML)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **Data Type** (config|dataset|api-response|export|schema)
- âœ… **Format** (JSON|CSV|YAML|XML)
- âœ… **Entities** (main data objects)
- âœ… **Key Fields** (important fields in schema)
- âœ… **Purpose** (what the data is for)
- âœ… Tags
- âœ… Notes

**Example:**
```
Title: "User Database Export"
Description: "JSON export of user records from production database"
Data Type: export
Format: JSON
Entities: users, profiles, permissions
Key Fields: id, email, name, created_at, role
Purpose: "User data backup and migration"
Tags: users, database, export, backup
```

---

### ğŸµ **AUDIO** (Podcasts, Recordings)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **Audio Type** (podcast|music|voice-memo|interview|lecture)
- âœ… Topics
- âœ… **Speakers** (people in audio)
- âœ… **Key Points** (main ideas)
- âœ… **Genre** (Professional/Casual/Music, etc.)
- âœ… Tags
- âœ… Notes

---

### ğŸ—‚ï¸ **HTML** (Web Pages, Generated Docs)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **Document Type** (article|report|documentation|presentation)
- âœ… Topics
- âœ… **Key Points** (main ideas)
- âœ… **Author** (if identifiable)
- âœ… **Source** (where it came from)
- âœ… Tags
- âœ… Notes

---

### ğŸŒ **URL** (Web Links)

**Fields Shown:**
- âœ… Title
- âœ… Description
- âœ… **URL Type** (article|documentation|tool|repository|resource)
- âœ… **Platform** (GitHub, Medium, React Docs, etc.)
- âœ… Topics
- âœ… **Category** (domain category)
- âœ… **Purpose** (why saved)
- âœ… Tags
- âœ… Notes

---

## Visual Example: Video Metadata Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Edit Metadata                                  âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ AI Metadata Generation                        â”‚
â”‚ [Generate with AI]                               â”‚
â”‚ [Custom prompt...]                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Asset Type: ğŸ¬ Video â€¢ Fields customized        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title                                            â”‚
â”‚ [Ilya Sutskever Interview____________]           â”‚
â”‚                                                  â”‚
â”‚ Short Description                                â”‚
â”‚ [One sentence summary________________]           â”‚
â”‚                                                  â”‚
â”‚ Long Description                                 â”‚
â”‚ [Detailed description_________________]          â”‚
â”‚ [____________________________________]           â”‚
â”‚                                                  â”‚
â”‚ Video Type                                       â”‚
â”‚ [interview___________________________]           â”‚
â”‚                                                  â”‚
â”‚ Topics (comma-separated)                         â”‚
â”‚ [AI, research, scaling_______________]           â”‚
â”‚                                                  â”‚
â”‚ Speakers (comma-separated)                       â”‚
â”‚ [Ilya Sutskever, Dwarkesh Patel______]           â”‚
â”‚                                                  â”‚
â”‚ Key Points (one per line)                        â”‚
â”‚ [- Scaling has limits________________]           â”‚
â”‚ [- Age of research__________________]           â”‚
â”‚ [- Value functions important_________]           â”‚
â”‚                                                  â”‚
â”‚ Target Audience                                  â”‚
â”‚ [AI researchers and developers_______]           â”‚
â”‚                                                  â”‚
â”‚ Tags (comma-separated)                           â”‚
â”‚ [ai, interview, research, ml_________]           â”‚
â”‚                                                  â”‚
â”‚ Notes                                            â”‚
â”‚ [Important insights on AI development]           â”‚
â”‚                                                  â”‚
â”‚ [Cancel] [Save]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

vs.

## Visual Example: Code Metadata Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Edit Metadata                                  âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ AI Metadata Generation                        â”‚
â”‚ [Generate with AI]                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Asset Type: ğŸ’» Code â€¢ Fields customized         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title                                            â”‚
â”‚ [React useAuth Hook__________________]           â”‚
â”‚                                                  â”‚
â”‚ Description                                      â”‚
â”‚ [Custom hook for authentication______]           â”‚
â”‚ [____________________________________]           â”‚
â”‚                                                  â”‚
â”‚ Programming Language                             â”‚
â”‚ [JavaScript/React____________________]           â”‚
â”‚                                                  â”‚
â”‚ Purpose                                          â”‚
â”‚ [Authentication state management_____]           â”‚
â”‚                                                  â”‚
â”‚ Functions/Classes (comma-separated)              â”‚
â”‚ [useAuth, login, logout, checkAuth___]           â”‚
â”‚                                                  â”‚
â”‚ Dependencies (comma-separated)                   â”‚
â”‚ [react, axios, jwt-decode____________]           â”‚
â”‚                                                  â”‚
â”‚ Complexity Level                                 â”‚
â”‚ [moderate____________________________]           â”‚
â”‚                                                  â”‚
â”‚ Tags (comma-separated)                           â”‚
â”‚ [react, hooks, auth, custom__________]           â”‚
â”‚                                                  â”‚
â”‚ Notes                                            â”‚
â”‚ [Reusable authentication logic_______]           â”‚
â”‚                                                  â”‚
â”‚ [Cancel] [Save]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Different fields for different types!** âœ…

---

## Implementation

### Key Functions

**1. `getMetadataSchemaForType(item)`**
- Determines asset type
- Returns schema with fields and labels
- 9 different schemas defined

**2. `buildDynamicMetadataFields(metadata, schema)`**
- Generates HTML for fields
- Handles different field types (string, textarea, array, list)
- Properly escapes values

**3. `showMetadataModal(itemId)` (Updated)**
- Gets item and metadata
- Determines schema
- Builds dynamic fields
- Injects into modal
- Shows asset type indicator

**4. `saveMetadata()` (Updated)**
- Reads all `.dynamic-field` elements
- Parses based on field type
- Handles arrays (comma-separated)
- Handles lists (line-separated)
- Saves to backend

---

## Field Type Rendering

### **String Fields**
```html
<input type="text" class="form-input dynamic-field" 
       data-field="language" 
       value="JavaScript/React">
```

### **Textarea Fields**
```html
<textarea class="form-input dynamic-field" 
          data-field="description" 
          rows="4">Detailed description...</textarea>
```

### **Array Fields** (comma-separated)
```html
<input type="text" class="form-input dynamic-field" 
       data-field="tags" 
       value="tag1, tag2, tag3">
<!-- Saved as: ["tag1", "tag2", "tag3"] -->
```

### **List Fields** (line-separated)
```html
<textarea class="form-input dynamic-field" 
          data-field="keyPoints" 
          rows="5">
Point 1
Point 2
Point 3
</textarea>
<!-- Saved as: ["Point 1", "Point 2", "Point 3"] -->
```

---

## Complete Flow Example

### Screenshot in "Design Work" Space

**1. Capture:**
```
User takes screenshot â†’ Saved to "Design Work" Space
```

**2. Auto-Generate (1 sec later):**
```
Space Context: {
  name: "Design Work",
  purpose: "UI/UX mockups and designs",
  tags: ["design", "ui", "figma"]
}

Prompt: "Analyze this SCREENSHOT...
         SPACE CONTEXT: Saved to 'Design Work' Space
         (Purpose: UI/UX mockups)
         How does this relate to UI/UX mockups?"

Claude Returns: {
  title: "Figma Login Screen Mockup",
  description: "UI mockup showing login form with email/password fields...",
  category: "design",
  extracted_text: "Sign In, Email, Password, Continue with Google",
  app_detected: "Figma",
  tags: ["figma", "login", "ui", "mockup", "design"]
}
```

**3. User Opens Metadata Modal:**
```
Modal shows:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Asset Type: ğŸ“¸ Image               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title: Figma Login Screen Mockup   â”‚
â”‚ Description: UI mockup showing...  â”‚
â”‚ Image Type: design                 â”‚
â”‚ Extracted Text: Sign In, Email...  â”‚
â”‚ App/Source: Figma                  â”‚
â”‚ Instructions: Reference for UI...  â”‚
â”‚ Tags: figma, login, ui, mockup     â”‚
â”‚ Notes: (user can add)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**All fields specific to IMAGE type!** âœ…

---

### Code Snippet in "API Project" Space

**1. Capture:**
```
User copies code â†’ Saved to "API Project" Space
```

**2. Auto-Generate:**
```
Space Context: {
  name: "API Project",
  purpose: "Backend API development",
  projectType: "Node.js API"
}

Prompt: "Analyze this CODE for Node.js API project..."

Returns: {
  title: "JWT Authentication Middleware",
  description: "Express middleware for token validation...",
  language: "JavaScript/Node.js",
  purpose: "API authentication",
  functions: ["authenticate", "validateToken"],
  dependencies: ["express", "jsonwebtoken"],
  complexity: "moderate"
}
```

**3. User Opens Metadata Modal:**
```
Modal shows:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Asset Type: ğŸ’» Code                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title: JWT Authentication...       â”‚
â”‚ Description: Express middleware... â”‚
â”‚ Programming Language: JavaScript...â”‚
â”‚ Purpose: API authentication        â”‚
â”‚ Functions: authenticate, validate..â”‚
â”‚ Dependencies: express, jsonwebtokenâ”‚
â”‚ Complexity Level: moderate         â”‚
â”‚ Tags: nodejs, api, auth, jwt       â”‚
â”‚ Notes: (user can add)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**All fields specific to CODE type!** âœ…

---

## Core Fields (All Types)

**Every type includes:**
- Title
- Description  
- Tags
- Notes

**Plus type-specific fields!**

---

## Benefits

### 1. **Clarity** ğŸ“‹
- See exactly what metadata is available
- No confusing empty fields
- Relevant fields only

### 2. **Richness** ğŸ“Š
- More detailed metadata
- Type-appropriate information
- Context-aware fields

### 3. **Usability** âœ¨
- Easy to edit
- Clear labels
- Proper input types (text vs textarea vs list)

### 4. **Consistency** ğŸ¯
- Generated metadata matches displayed fields
- No mismatch between backend and UI
- Schema-driven approach

---

## Files Modified

**1. clipboard-viewer.js** (~200 lines added)
- Added `getMetadataSchemaForType()` - 9 schema definitions
- Added `buildDynamicMetadataFields()` - Dynamic HTML generation
- Updated `showMetadataModal()` - Uses dynamic fields
- Updated `saveMetadata()` - Reads dynamic fields

**2. clipboard-viewer.html** (~30 lines changed)
- Added `#dynamicMetadataFields` container
- Added `#assetTypeIndicator` display
- Moved static fields to `#legacyMetadataFields` (hidden)

**3. clipboard-manager-v2-adapter.js** (2 calls updated)
- Uses MetadataGenerator for auto-generation
- Uses MetadataGenerator for manual generation

---

## Status

âœ… **COMPLETE - Fully Integrated**

**What works:**
- âœ… Auto-generation with specialized prompts
- âœ… Space context included in all prompts
- âœ… Type-specific metadata fields
- âœ… Dynamic modal displays correct fields
- âœ… Save works with all field types
- âœ… Backward compatible with legacy data

---

## Summary

**YES - Each asset type has:**
1. âœ… **Different metadata schema** (9 types)
2. âœ… **Specialized AI prompts** with Space context
3. âœ… **Type-specific fields** in metadata
4. âœ… **Dynamic modal** showing relevant fields only

**Exactly what you asked for!** ğŸ‰

---

## Test It

```bash
cd /Users/richardwilson/Onereach_app
npm run package:mac
open dist/mac-arm64/Onereach.ai.app
```

Then:
1. Capture different types (screenshot, video, code)
2. Wait for "âœ¨ AI Analysis Complete"
3. Click "Edit Metadata"
4. See **different fields** for each type!

**The modal adapts to each asset type!** âœ¨
